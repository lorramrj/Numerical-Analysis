
#include "taylor.h"

/*
   f(x) = tan(x) em torno de x=0
    ---------------------------------------------------------
    f(x) = tan(x)                                                       f(0) = 0
    f'(x) = sec^2(x)                                                    f'(0) = 1
    f''(x) = 2sec^2(x)tan(x)                                            f''(0) = 0
    f'''(x) = 4sec^2(x)tan^2(x) + 2sec^4(x)                             f'''(0) = 2
    f''''(x) = 8sec^2(x)tan^3(x) + 16sec^4(x)tan(x)                     f''''(0) = 0            
    f'''''(x) = 16sec^2(x)tan^4 + 88sec^4(x)tan^2(x) + 16sec^6(x)       f'''''(0) = 16
    
    T5(x) = f(0) +  (f'(0)/1!)(x) + (f''(0)/2!)(x^2) + (f'''(0)/3!)(x^3) + (f''''(0)/4!)(x^4) + (f'''''(0)/5!)(x^5)
    T5(x) = 0 + x + 0 + 2(x^3)/3! + 0 + 16(x^5)/5!
    ==============================================
    T5(x) = x + x^3/3 + 2x^5/15

*/
double tan1 (double x) {
    return x + (x*x*x)/3 + (2*(x*x*x*x*x))/15;
}


/*
   f(x) = sin(x) em torno de x=0
    ---------------------------------------------------------
    f(x) = sin(x)                                                       f(0) = 0
    f'(x) = cos(x)                                                      f'(0) = 1
    f''(x) = -sin(x)                                                    f''(0) = 0 
    f'''(x) = -cos(x)                                                   f'''(0) = -1

    Tsin3(x) = f(0) + (f'(0)/1!)x + (f''(0)/2!)x^2 + (f'''(0)/3!)x^3
    Tsin3(x) = 0 + (1/1)x + (0/2!)x^2 + (-1/3!)x^3
    ==============================================
    Tsin3(x) = x - x^3/6


   g(x) = cos(x) em torno de x=0
    ---------------------------------------------------------
    g(x) = cos(x)                                                       f(0) = 1
    g'(x) = -sen(x)                                                     f'(0) = 0
    g''(x) = -cos(x)                                                   f''(0) = -1

    Tcos2(x) = g(0) + (g'(0)/1!)x + (g''(0)/2!)x^2 
    Tcos2(x) = 1 + (0/1)x + (-1/2!)x^2 
    ==============================================
    Tcos2(x) = 1 - x^2/2

   => Portanto: tan(x) = Tsin3(x)/Tcos2(x) = (x - x^3/6) / (1 - x^2/2)

*/

double tan2 (double x) {
    return ((x - (x*x*x)/6)/(1 - (x*x)/2)); 
}
